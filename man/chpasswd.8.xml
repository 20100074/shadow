<?xml version="1.0" encoding="UTF-8"?>
<refentry id='chpasswd.8'>
  <!-- $Id$ -->
  <refmeta>
    <refentrytitle>chpasswd</refentrytitle>
    <manvolnum>8</manvolnum>
    <refmiscinfo class="sectdesc">System Management Commands</refmiscinfo>
  </refmeta>
  <refnamediv id='name'>
    <refname>chpasswd</refname>
    <refpurpose>update passwords in batch mode</refpurpose>
  </refnamediv>

  <refsynopsisdiv id='synopsis'>
    <cmdsynopsis>
      <command>chpasswd</command>
      <arg choice='opt'>
	<replaceable>options</replaceable>
      </arg>
    </cmdsynopsis>
  </refsynopsisdiv>

  <refsect1 id='description'>
    <title>DESCRIPTION</title>
    <para>
      The <command>chpasswd</command> command reads a list of user name and
      password pairs from standard input and uses this information to update
      a group of existing users. Each line is of the format:
    </para>
    <para>
      <emphasis remap='I'>user_name</emphasis>:<emphasis
      remap='I'>password</emphasis>
    </para>
    <para>
      By default the supplied password must be in clear-text. Default
      encryption algorithm is DES. Also the password age will be updated, if
      present.
    </para>
    <para>
      The default encryption algorithm can be defined for the system with
      the ENCRYPT_METHOD variable of <filename>/etc/login.defs</filename>,
      and can be overwiten with the <option>-e</option>,
      <option>-m</option>, or <option>-c</option> options.
    </para>
    <para>
      This command is intended to be used in a large system environment
      where many accounts are created at a single time.
    </para>
  </refsect1>

  <refsect1 id='options'>
    <title>OPTIONS</title>
    <para>
      The options which apply to the <command>chpasswd</command> command
      are:
    </para>
    <variablelist remap='IP'>
      <varlistentry>
	<term><option>-c</option>, <option>--crypt-method</option></term>
	<listitem>
	  <para>Use the specified method to encrypt the passwords.</para>
	  <para>
	    The available methods are DES, MD5, and SHA256 or SHA512
	    if compiled with the ENCRYPTMETHOD_SELECT flag.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><option>-e</option>, <option>--encrypted</option></term>
	<listitem>
	  <para>Supplied passwords are in encrypted form.</para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><option>-h</option>, <option>--help</option></term>
	<listitem>
	  <para>Display help message and exit.</para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><option>-m</option>, <option>--md5</option></term>
	<listitem>
	  <para>
	    Use MD5 encryption instead of DES when the supplied passwords are
	    not encrypted.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><option>-s</option>, <option>--sha-rounds</option></term>
	<listitem>
	  <para>
	    Use the specified number of rounds to encrypt the passwords.
	  </para>
	  <para>
	    The value 0 means that the system will choose the default
	    number of rounds for the crypt method (5000).
	  </para>
	  <para>
	    A minimal value of 1000 and a maximal value of 999,999,999
	    will be enforced.
	  </para>
	  <para>
	    You can only use this option with the SHA256 or SHA512
	    crypt method.
	  </para>
	  <para>
	    By default, the number of rounds is defined by the
	    SHA_CRYPT_MIN_ROUNDS and SHA_CRYPT_MAX_ROUNDS variables in
	    <filename>/etc/login.defs</filename>.
	  </para>
	</listitem>
      </varlistentry>
    </variablelist>
  </refsect1>

  <refsect1 id='caveats'>
    <title>CAVEATS</title>
    <para>
      Remember to set permissions or umask to prevent readability of
      unencrypted files by other users.
    </para>
    <para>
      <command>chpasswd</command> does not use PAM to update the passwords.
      Thus, It only updates the passwords from the
      <filename>/etc/passwd</filename> and <filename>/etc/shadow</filename>
      databases, and does not support the various checks provided by PAM
      modules.
    </para>
  </refsect1>

  <refsect1 id='see_also'>
    <title>SEE ALSO</title>
    <para>
      <citerefentry>
	<refentrytitle>passwd</refentrytitle><manvolnum>1</manvolnum>
      </citerefentry>,
      <citerefentry>
	<refentrytitle>newusers</refentrytitle><manvolnum>8</manvolnum>
      </citerefentry>,
      <citerefentry>
	<refentrytitle>useradd</refentrytitle><manvolnum>8</manvolnum>
      </citerefentry>,
      <citerefentry>
	<refentrytitle>login.defs</refentrytitle><manvolnum>5</manvolnum>
      </citerefentry>.
    </para>
  </refsect1>
</refentry>
